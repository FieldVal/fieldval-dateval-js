var logger;"function"==typeof require&&(logger=require("tracer").console(),FieldVal=require("fieldval"),BasicVal=require("fieldval-basicval"));var DateVal={errors:{invalid_date_format:function(){return{error:111,error_message:"Invalid date format."}},invalid_date:function(){return{error:112,error_message:"Invalid date."}},invalid_date_format_string:function(){return{error:114,error_message:"Invalid date format string."}}},date_format:function(e){var r=function(r,a){for(var t=[],i=0,o=!1;i<r.length&&!o;){var l=!1;for(var n in DateVal.date_components){var d=r.substring(i,i+n.length);if(d===n){t.push(n),i+=n.length,l=!0;break}}l||(o=!0)}return o?FieldVal.create_error(DateVal.errors.invalid_date_format_string,e):void a(t)};return e?(e.check=r,e):{check:r}},date:function(e,r){r=r||{};var a,t=DateVal.date_format().check(e,function(e){a=e});t&&console.error&&console.error(t.error_message);var i=function(e,t){for(var i={},o=[],l=0,n=null,d=null,s=-1,f=!1;l<e.length&&!f;)if(s++,n=a[s],d=DateVal.date_components[n],0!==d){for(var u=d[0],v=d[d.length-1],_="",c=0;v>c;c++){var m=e[l+c];if(void 0===m)break;var V=m.charCodeAt(0);if(48>V||V>57){if(c===u)break;f=!0;break}_+=m}if(l+=c,f)break;var h=parseInt(_);o.push(_),"yyyy"===n||"yy"===n?i.year=h:"MM"===n||"M"===n?i.month=h:"dd"===n||"d"===n?i.day=h:"hh"===n||"h"===n?i.hour=h:"mm"===n||"m"===n?i.minute=h:("ss"===n||"s"===n)&&(i.second=h)}else{if(e[l]!==n){f=!0;break}o.push(null),l++}if(f)return FieldVal.create_error(DateVal.errors.invalid_date_format,r);if(void 0!==i.hour&&(i.hour<0||i.hour>23))return FieldVal.create_error(DateVal.errors.invalid_date,r);if(void 0!==i.minute&&(i.minute<0||i.minute>59))return FieldVal.create_error(DateVal.errors.invalid_date,r);if(void 0!==i.second&&(i.second<0||i.second>59))return FieldVal.create_error(DateVal.errors.invalid_date,r);if(void 0!==i.month){var D=i.month;if(D>12)return FieldVal.create_error(DateVal.errors.invalid_date,r);if(i.day){var y=i.day;if(i.year){var T=i.year;if(2==D)if(T%400==0||T%100!=0&&T%4==0){if(y>29)return FieldVal.create_error(DateVal.errors.invalid_date,r)}else if(y>28)return FieldVal.create_error(DateVal.errors.invalid_date,r)}if(4===D||6===D||9===D||11===D){if(y>30)return FieldVal.create_error(DateVal.errors.invalid_date,r)}else if(2===D){if(y>29)return FieldVal.create_error(DateVal.errors.invalid_date,r)}else if(y>31)return FieldVal.create_error(DateVal.errors.invalid_date,r)}}else if(i.day&&i.day>31)return FieldVal.create_error(DateVal.errors.invalid_date,r);if(r.emit)if(r.emit===DateVal.EMIT_COMPONENT_ARRAY)t(o);else if(r.emit===DateVal.EMIT_OBJECT)t(i);else if(r.emit===DateVal.EMIT_DATE){var g=new Date(0);g.setUTCFullYear(0),void 0!==i.year&&g.setYear(i.year),void 0!==i.month&&g.setUTCMonth(i.month-1),void 0!==i.day&&g.setUTCDate(i.day),void 0!==i.hour&&g.setUTCHours(i.hour),void 0!==i.minute&&g.setUTCMinutes(i.minute),void 0!==i.second&&g.setUTCSeconds(i.second),t(g)}};return r?(r.check=i,r):{check:i}}};DateVal.EMIT_COMPONENT_ARRAY={},DateVal.EMIT_DATE={},DateVal.EMIT_OBJECT={},DateVal.date_components={yyyy:[4],yy:[2],MM:[2],M:[1,2],dd:[2],d:[1,2],hh:[2],h:[1,2],mm:[2],m:[1,2],ss:[2],s:[1,2]," ":0,"-":0,"/":0,":":0},"undefined"!=typeof module&&(module.exports=DateVal);