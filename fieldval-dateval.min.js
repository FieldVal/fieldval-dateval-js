"function"==typeof require&&(FieldVal=require("fieldval"),BasicVal=require("fieldval-basicval"));var DateVal={errors:{invalid_date_format:function(){return{error:111,error_message:"Invalid date format."}},invalid_date:function(){return{error:112,error_message:"Invalid date."}},invalid_date_format_string:function(){return{error:114,error_message:"Invalid date format string."}}},date_format:function(e){var r=function(r,a){for(var t=[],i=0,n=!1;i<r.length&&!n;){var l=!1;for(var o in DateVal.date_components){var d=r.substring(i,i+o.length);if(d===o){t.push(o),i+=o.length,l=!0;break}}l||(n=!0)}return n?FieldVal.create_error(DateVal.errors.invalid_date_format_string,e):void a(t)};return e?(e.check=r,e):{check:r}},date_with_format_array:function(e,r){for(var a="",t=0;t<r.length;t++){var i=r[t],n=DateVal.date_components[i];if(0===n)a+=i;else{var l;"yyyy"===i?l=e.getUTCFullYear():"yy"===i?l=e.getUTCFullYear().toString().substring(2):"MM"===i||"M"===i?l=e.getUTCMonth()+1:"dd"===i||"d"===i?l=e.getUTCDate():"hh"===i||"h"===i?l=e.getUTCHours():"mm"===i||"m"===i?l=e.getUTCMinutes():("ss"===i||"s"===i)&&(l=e.getUTCSeconds()),a+=DateVal.pad_to_valid(l.toString(),n)}}return a},pad_to_valid:function(e,r){var a=BasicVal.integer({parse:!0}).check(e);if(a)return e;for(var t=0;t<r.length;t++){var i=r[t];if(e.length<=i){for(var n=i-e.length,l=0;n>l;l++)e="0"+e;return e}}return e},date:function(e,r){r=r||{};var a,t=DateVal.date_format().check(e,function(e){a=e});t&&console.error&&console.error(t.error_message);var i=function(e,t){for(var i={},n=[],l=0,o=null,d=null,s=-1,f=!1;l<e.length&&!f;)if(s++,o=a[s],d=DateVal.date_components[o],0!==d){for(var u=d[0],_=d[d.length-1],v="",c=0;_>c;c++){var V=e[l+c];if(void 0===V)break;var m=V.charCodeAt(0);if(48>m||m>57){if(c===u)break;f=!0;break}v+=V}if(l+=c,f)break;var h=parseInt(v);n.push(v),"yyyy"===o||"yy"===o?i.year=h:"MM"===o||"M"===o?i.month=h:"dd"===o||"d"===o?i.day=h:"hh"===o||"h"===o?i.hour=h:"mm"===o||"m"===o?i.minute=h:("ss"===o||"s"===o)&&(i.second=h)}else{if(e[l]!==o){f=!0;break}n.push(null),l++}if(f)return FieldVal.create_error(DateVal.errors.invalid_date_format,r);if(void 0!==i.hour&&(i.hour<0||i.hour>23))return FieldVal.create_error(DateVal.errors.invalid_date,r);if(void 0!==i.minute&&(i.minute<0||i.minute>59))return FieldVal.create_error(DateVal.errors.invalid_date,r);if(void 0!==i.second&&(i.second<0||i.second>59))return FieldVal.create_error(DateVal.errors.invalid_date,r);if(void 0!==i.month){var y=i.month;if(y>12)return FieldVal.create_error(DateVal.errors.invalid_date,r);if(1>y)return FieldVal.create_error(DateVal.errors.invalid_date,r);if(i.day){var D=i.day;if(1>D)return FieldVal.create_error(DateVal.errors.invalid_date,r);if(i.year){var g=i.year;if(2==y)if(g%400===0||g%100!==0&&g%4===0){if(D>29)return FieldVal.create_error(DateVal.errors.invalid_date,r)}else if(D>28)return FieldVal.create_error(DateVal.errors.invalid_date,r)}if(4===y||6===y||9===y||11===y){if(D>30)return FieldVal.create_error(DateVal.errors.invalid_date,r)}else if(2===y){if(D>29)return FieldVal.create_error(DateVal.errors.invalid_date,r)}else if(D>31)return FieldVal.create_error(DateVal.errors.invalid_date,r)}}else if(i.day){if(i.day>31)return FieldVal.create_error(DateVal.errors.invalid_date,r);if(i.day<1)return FieldVal.create_error(DateVal.errors.invalid_date,r)}if(r.emit)if(r.emit===DateVal.EMIT_COMPONENT_ARRAY)t(n);else if(r.emit===DateVal.EMIT_OBJECT)t(i);else if(r.emit===DateVal.EMIT_DATE){var T=new Date(0);T.setUTCFullYear(0),void 0!==i.year&&T.setYear(i.year),void 0!==i.month&&T.setUTCMonth(i.month-1),void 0!==i.day&&T.setUTCDate(i.day),void 0!==i.hour&&T.setUTCHours(i.hour),void 0!==i.minute&&T.setUTCMinutes(i.minute),void 0!==i.second&&T.setUTCSeconds(i.second),t(T)}};return r?(r.check=i,r):{check:i}}};DateVal.EMIT_COMPONENT_ARRAY={},DateVal.EMIT_DATE={},DateVal.EMIT_OBJECT={},DateVal.date_components={yyyy:[4],yy:[2],MM:[2],M:[1,2],dd:[2],d:[1,2],hh:[2],h:[1,2],mm:[2],m:[1,2],ss:[2],s:[1,2]," ":0,"-":0,"/":0,":":0},"undefined"!=typeof module&&(module.exports=DateVal);